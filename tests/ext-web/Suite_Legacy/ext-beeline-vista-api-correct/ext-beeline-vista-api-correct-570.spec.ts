import { test, expect } from '@playwright/test';
import path from 'path';
import * as stepGroups from '../../../src/helpers/step-groups';

test.describe('EXT: Beeline-Vista API [Correct]', () => {
  let vars: Record<string, string> = {};

  test.beforeEach(async () => {
    vars = {};
  });

  test('EXT: Beeline-Vista API [Correct]', async ({ page }) => {
    // API: Get Auth
    const _apiResponse_10768 = await page.request.post("https://ppe-auth.cre8techuat.com/oauth/token", { headers: {} });
    const _apiBody_10768 = await _apiResponse_10768.json();
    // API: Get Pricing API
    const _apiResponse_10771 = await page.request.post("https://ppe-extapi.cre8techuat.com/rest/v1/lp-ppe-api/pricing/search", { data: {"id":3388,"apiStepId":8641,"type":"JSON","body":"{\n  \"id\": \"665a0bceac546f0001777704\",\n  \"allowModifiedDate\": true,\n  \"titleVendorQuestions\": [],\n  \"useExternalFees\": true,\n  \"showTitleQuestion\": true,\n  \"debugLevel\": \"WARNING\",\n  \"loanAmountCriteria\": [],\n  \"termsCriteria\": [\n    \"30\"\n  ],\n  \"termsInMonths\": false,\n  \"loanPurposeCriteria\": [\n    \"Purchase\"\n  ],\n  \"loanTypeCriteria\": [\n    \"Fixed\"\n  ],\n  \"varLoanTypeCriteria\": [],\n  \"titleVendors\": [],\n  \"criteria\": {\n    \"id\": \"665a0bceac546f0001777705\",\n    \"purchasePrice\": 500000,\n    \"loanAmount\": 400000,\n    \"rehabBudget\": 0,\n    \"totalLoanAmount\": 400000,\n    \"computeApr\": true,\n    \"totalLoanAmountByMortgageType\": {},\n    \"totalLoanAmountByFHALoanType\": {},\n    \"subordinateLoanAmount\": 0,\n    \"pmiType\": \"None\",\n    \"monthlyIncome\": 16666.666666666668,\n    \"monthlyDebt\": 5333,\n    \"lmiData\": {\n      \"lmiTract\": 0,\n      \"borLimit\": 0,\n      \"chaseAA\": false\n    },\n    \"dutyToServe\": false,\n    \"lineAmount\": 0,\n    \"drawAmount\": 0,\n    \"constructionDrawAmount\": 0,\n    \"renovationCost\": 0,\n    \"cashoutAmount\": 0,\n    \"appraisedValue\": 0,\n    \"isFirstLienSame\": \"\",\n    \"monthlyReserve\": 0,\n    \"employeeLoan\": \"\",\n    \"dscr\": 0,\n    \"docType\": \"FullDoc\",\n    \"closedEnd\": false,\n    \"balloon\": false,\n    \"rural\": false,\n    \"firstTimeHomeBuyer\": false,\n    \"selfEmployed\": false,\n    \"nonWarrantableProject\": false,\n    \"renovationLoan\": false,\n    \"communitySecond\": false,\n    \"numberOfCoBorrower\": 1,\n    \"numberOfBorrower\": 1,\n    \"loanYear\": 30,\n    \"loanPurpose\": \"Purchase\",\n    \"loanType\": \"Fixed\",\n    \"paymentInterestType\": \"FullPITI\",\n    \"helocCriteria\": {\n      \"applyLineAmount\": false\n    },\n    \"percentageFeeCriteria\": {\n      \"fundingFeeFinancedType\": \"YES\",\n      \"fundingFeeWaived\": false\n    },\n    \"mortgageTypes\": [\n      \"Conventional\"\n    ],\n    \"affordableHousingTypes\": [\n      \"None\"\n    ],\n    \"mortgageLimitMapByYear\": {\n      \"2024\": {\n        \"mortgageLimit\": \"Conforming\",\n        \"mortgageLimitFHA\": \"Conforming\",\n        \"fhaMortgageLimit\": 1149825,\n        \"matchingCountyLoanLimit\": 1149825\n      }\n    },\n    \"highBalanceCountyMappedByYear\": {},\n    \"mortgageLimit\": \"Conforming\",\n    \"fhaMortgageLimit\": 1149825,\n    \"propertyUse\": \"PrimaryResidence\",\n    \"ownProperties\": 0,\n    \"veteranType\": \"Active_Or_Veteran\",\n    \"vaUsageType\": \"First_Use\",\n    \"ufmipFinanced\": \"YES\",\n    \"fundingFeeFinanced\": \"YES\",\n    \"guranteeFeeFinanced\": \"YES\",\n    \"propertyValuationType\": \"Full_Appraisal\",\n    \"calculatedfeeAmount\": 0,\n    \"calculatedFeeByMortgageType\": {},\n    \"calculatedFeeByFHALoanType\": {},\n    \"affinityCode\": \"\",\n    \"affinityCodes\": [],\n    \"specialMortgageOptions\": [],\n    \"inclusive\": false,\n    \"varaiableLoanTypes\": [],\n    \"fico\": 760,\n    \"fhaLoanTypes\": [\n      \"STANDARD\"\n    ],\n    \"vaLoanTypes\": [\n      \"ALL\"\n    ],\n    \"cemaIndicator\": false,\n    \"downPaymentAmount\": 100000,\n    \"compensationType\": \"LenderCompPlan\",\n    \"studentLoanIndicator\": false,\n    \"appraisalConditionAsIs\": true,\n    \"totalLoanAmountByVaType\": {},\n    \"normalHelocBehavior\": true,\n    \"interestOnly\": false,\n    \"payoffStatusIndicatorFirstLien\": false,\n    \"payoffStatusIndicatorSecondLien\": false,\n    \"existingFirstLien\": true,\n    \"subordinate\": false,\n    \"assumption\": false,\n    \"assumptionRate\": 0,\n    \"rent\": 0,\n    \"otherExpenses\": 0,\n    \"rentalPropertyCashFlowAmount\": 0,\n    \"firstLienPaymentAmount\": 0,\n    \"subordinateSubType\": \"NONE\",\n    \"ltv\": 0.8,\n    \"highBalanceCounty\": false,\n    \"cltv\": 0.8,\n    \"loanDownPayment\": 0,\n    \"dti\": 0.31998,\n    \"lenderFeeWaiver\": false,\n    \"escrowWaiver\": false,\n    \"valueOfCollateral\": 500000,\n    \"hcltvLineAmount\": 0.8,\n    \"hcltvDrawAmount\": 0.8,\n    \"loanDownPayement\": 0,\n    \"fhaEndorsementDate\": \"2024-05-31T17:41:36.082Z\",\n    \"ami\": 105700,\n    \"incomeAmiRatio\": 1.8921475875118259,\n    \"downRate\": 0.2,\n    \"borrowerCompPlanAmount\": null,\n    \"annualIncome\": 200000\n  },\n  \"property\": {\n    \"id\": \"665a0bceac546f0001777706\",\n    \"allowModifiedDate\": true,\n    \"creationDate\": \"2024-05-31T17:41:34.000Z\",\n    \"modifiedDate\": \"2024-05-31T17:41:34.000Z\",\n    \"address\": {\n      \"censustract\": \"\",\n      \"street\": \"\",\n      \"streetCont\": \"\",\n      \"city\": \"Pasadena\",\n      \"zip\": \"91106\",\n      \"zipExt\": \"\",\n      \"state\": \"CA\",\n      \"province\": \"\",\n      \"county\": \"06037\",\n      \"countyName\": \"Los Angeles\",\n      \"country\": \"US\",\n      \"countyFips\": \"\",\n      \"stateFips\": \"\"\n    },\n    \"propertyType\": \"SingleFamily\",\n    \"attachmentType\": \"Attached\",\n    \"numberOfUnit\": 1,\n    \"bedrooms\": 0,\n    \"bathrooms\": 0,\n    \"finishedSqFt\": 0,\n    \"lotSizeSqFt\": 0,\n    \"lotSizeAcre\": 0,\n    \"yearBuilt\": 0,\n    \"mls\": \"\",\n    \"totalRooms\": 0,\n    \"propertyDescription\": \"\",\n    \"price\": 0,\n    \"priceDate\": \"\",\n    \"hoa\": 0,\n    \"taxAssessment\": 0,\n    \"taxAssessmentYear\": \"\",\n    \"propertyTaxPercent\": 0,\n    \"propertyTaxYear\": \"\",\n    \"lastSoldPrice\": 0,\n    \"lastSoldDate\": \"\",\n    \"jsonImages\": [],\n    \"links\": [],\n    \"forSale\": false,\n    \"features\": [],\n    \"constructions\": [],\n    \"facts\": []\n  },\n  \"brokerCriteria\": {\n    \"id\": \"665a0bceac546f0001777707\",\n    \"allowModifiedDate\": true,\n    \"creationDate\": \"2024-05-31T17:41:34.000Z\",\n    \"modifiedDate\": \"2024-05-31T17:41:34.000Z\",\n    \"searchContext\": {},\n    \"scriptWeight\": 100,\n    \"overrideExistingComplan\": false,\n    \"qmFilterLimit\": 3,\n    \"lockGroups\": [],\n    \"pointsFinancedDollarAmount\": 0,\n    \"adjCodeToExclude\": [],\n    \"adjNameToExclude\": [],\n    \"rateTypes\": [],\n    \"subRateTypes\": [],\n    \"qmTypes\": [],\n    \"view\": \"LenderPaid\",\n    \"businessSourceType\": null,\n    \"feeServicerList\": [],\n    \"adjustments\": [],\n    \"rangeComplan\": {\n      \"@class\": \"com.cre8techlabs.entity.range.DoubleRangeGeLe\"\n    },\n    \"sortStrategy\": \"APR\",\n    \"priceBucketList\": [],\n    \"resultPerBucket\": 1,\n    \"executionType\": \"BestEfforts\",\n    \"dayLocks\": 30,\n    \"dayLocksList\": [\n      0,\n      7,\n      15,\n      30,\n      45,\n      60,\n      75,\n      90,\n      120,\n      150,\n      180,\n      270,\n      360,\n      365\n    ],\n    \"ausList\": [\n      \"None\",\n      \"GUS\",\n      \"MUW\",\n      \"LP\",\n      \"DU\"\n    ],\n    \"ausIndicator\": \"\",\n    \"closingCostRange\": {\n      \"@class\": \"com.cre8techlabs.entity.broker.BrokerCriteria$RangeClosingCost\",\n      \"closestToPar\": false,\n      \"infinite\": true\n    },\n    \"displayConventionalRate\": false\n  },\n  \"accessCriteria\": {\n    \"id\": \"665a0bceac546f0001777708\",\n    \"marketPlaceSearch\": false,\n    \"dataLog\": true,\n    \"companyIds\": [],\n    \"companyMap\": {},\n    \"ratePeriodMap\": {},\n    \"overrideNode\": 25,\n    \"fieldsToRemove\": [],\n    \"userContext\": {}\n  },\n  \"miCriteria\": {\n    \"amortizationType\": \"FullyAmmortized\",\n    \"loanType\": \"Fixed\",\n    \"duLpDecision\": \"DU_Approve_Eligible\",\n    \"buyDownPercent\": \"None\",\n    \"originationChannel\": \"Retail\",\n    \"renewalType\": \"Constant\",\n    \"paymentPlan\": \"EZMonthly\",\n    \"paymentType\": \"Monthly\",\n    \"monthlyPlanRefundable\": false,\n    \"singlePlanRefundable\": false,\n    \"borrowerNonTraditionalCredit\": false,\n    \"coBorrowerNonTraditionalCredit\": false,\n    \"borrowerSelfEmployed\": false,\n    \"coBorrowerSelfEmployed\": false,\n    \"needCoBorrower\": false,\n    \"initialPremiumAtClosing\": \"Deferred\",\n    \"rateQuoteAllProductIndicator\": false,\n    \"rateQuoteProductComparisonIndicator\": false,\n    \"miPremiumFinancedIndicator\": false,\n    \"premiumRatePlanType\": \"Level\",\n    \"useDefaultEstimatedMi\": true,\n    \"numberOfDeferredPayments\": 0,\n    \"miCompanyId\": \"580435cbe4b0cec78b57b681\",\n    \"miCompanyName\": \"Arch MI\"\n  },\n  \"dynamicPropertiesMap\": {\n    \"Global_CASHOUTAMOUNT\": {\n      \"fieldId\": \"Global_CASHOUTAMOUNT\"\n    },\n    \"IncomeDocType\": {\n      \"fieldId\": \"IncomeDocType\"\n    },\n    \"Global_INTERESTONLY\": {\n      \"fieldId\": \"Global_INTERESTONLY\"\n    },\n    \"DSCRRATIO\": {\n      \"fieldId\": \"DSCRRATIO\"\n    },\n    \"Global_FIRSTTIMEHOMEBUYER\": {\n      \"fieldId\": \"Global_FIRSTTIMEHOMEBUYER\"\n    },\n    \"Global_RURAL\": {\n      \"fieldId\": \"Global_RURAL\"\n    },\n    \"Citizenship\": {\n      \"fieldId\": \"Citizenship\"\n    },\n    \"GLOBAL_Duty_To_Serve\": {\n      \"fieldId\": \"GLOBAL_Duty_To_Serve\"\n    },\n    \"Global_TX50A6\": {\n      \"fieldId\": \"Global_TX50A6\"\n    },\n    \"BankruptcySeasoning\": {\n      \"fieldId\": \"BankruptcySeasoning\"\n    },\n    \"GLOBAL_RESERVES\": {\n      \"fieldId\": \"GLOBAL_RESERVES\"\n    },\n    \"GLOBAL_GIFTFUNDPERCENT\": {\n      \"fieldId\": \"GLOBAL_GIFTFUNDPERCENT\"\n    },\n    \"HousingHistory\": {\n      \"fieldId\": \"HousingHistory\"\n    },\n    \"MORT90LATESLAST24M\": {\n      \"fieldId\": \"MORT90LATESLAST24M\"\n    },\n    \"MORT90LATESLAST12M\": {\n      \"fieldId\": \"MORT90LATESLAST12M\"\n    },\n    \"MORT60LATESLAST24M\": {\n      \"fieldId\": \"MORT60LATESLAST24M\"\n    },\n    \"MORT60LATESLAST12M\": {\n      \"fieldId\": \"MORT60LATESLAST12M\"\n    },\n    \"MORT30LATESLAST24M\": {\n      \"fieldId\": \"MORT30LATESLAST24M\"\n    },\n    \"MORT30LATESLAST12M\": {\n      \"fieldId\": \"MORT30LATESLAST12M\"\n    },\n    \"MORT120LATESLAST24M\": {\n      \"fieldId\": \"MORT120LATESLAST24M\"\n    },\n    \"MORT120LATESLAST12M\": {\n      \"fieldId\": \"MORT120LATESLAST12M\"\n    },\n    \"GLOBAL_VacantProperty\": {\n      \"fieldId\": \"GLOBAL_VacantProperty\"\n    },\n    \"GLOBAL_DECLININGMARKET\": {\n      \"fieldId\": \"GLOBAL_DECLININGMARKET\"\n    },\n    \"GLOBAL_MixedUse\": {\n      \"fieldId\": \"GLOBAL_MixedUse\"\n    },\n    \"GLOBAL_DELAYEDFINANCING\": {\n      \"fieldId\": \"GLOBAL_DELAYEDFINANCING\"\n    },\n    \"GLOBAL_Additional_Property_Type\": {\n      \"fieldId\": \"GLOBAL_Additional_Property_Type\"\n    }\n  },\n  \"rateGridIds\": [],\n  \"rateProgramIds\": [],\n  \"ratePeriodIds\": [],\n  \"investors\": [],\n  \"investorIds\": [],\n  \"test\": false,\n  \"skipAdjustments\": false,\n  \"filter\": {\n    \"programNames\": [],\n    \"productCode\": [],\n    \"getRateGridFilterReason\": false,\n    \"ineligibleProduct\": false,\n    \"priceIneligibleProduct\": false,\n    \"rateFilter\": {}\n  },\n  \"globalGroupAdjustmentMap\": {},\n  \"showDisqualify\": false,\n  \"showDisqualifyRules\": true,\n  \"sortAscPoints\": true,\n  \"showUnmatchCompPlan\": true,\n  \"feeCriteria\": {},\n  \"closingCost\": {\n    \"total\": 0,\n    \"closingCostGroup\": [],\n    \"settlementCost\": {\n      \"origination\": {\n        \"othersLabel\": \"Fee\",\n        \"others\": 0,\n        \"underwritingLabel\": \"Underwriting\",\n        \"underwriting\": 0,\n        \"administrationLabel\": \"Administration Fee\",\n        \"lenderCreditLabel\": \"Lender Credit\",\n        \"total\": 0\n      },\n      \"titleService\": {\n        \"overrideTitle\": false,\n        \"titleInsuranceLabel\": \"Title Insurance Cost\",\n        \"borrowerTitlePaidPercentLabel\": \"Borrower Title Insurance Percent\",\n        \"borrowerTitlePaidPercent\": 0,\n        \"overrideEscrow\": false,\n        \"escrowCostLabel\": \"Escrow Cost\",\n        \"borrowerEscrowPaidPercentLabel\": \"Borrower Escrow Cost Percent\",\n        \"borrowerEscrowPaidPercent\": 0,\n        \"notarySignLabel\": \"Notary Sign\",\n        \"notarySign\": 0,\n        \"total\": 0\n      },\n      \"thirdPartyServices\": {\n        \"appraisalLabel\": \"Appraisal\",\n        \"appraisal\": 0,\n        \"taxServiceLabel\": \"Tax Service\",\n        \"taxService\": 0,\n        \"creditReportLabel\": \"Credit Report\",\n        \"creditReport\": 0,\n        \"floodCertificationLabel\": \"Floor Certification\",\n        \"floodCertification\": 0,\n        \"overnightLabel\": \"Overnight\",\n        \"overnight\": 0,\n        \"recordingLabel\": \"Recording\",\n        \"recording\": 0,\n        \"total\": 0\n      },\n      \"closingCostGroup\": [],\n      \"total\": 0\n    },\n    \"useClosingCost\": false,\n    \"useCompanyDefaultClosingCost\": false,\n    \"useErnstCost\": false,\n    \"directCustomFee\": false,\n    \"allowErnstQuote\": false\n  },\n  \"multiSearchClosingCostList\": [],\n  \"showInterpolatedPricing\": false,\n  \"targetInterpolatedPrices\": [],\n  \"onlyShowTargetPrice\": false,\n  \"onlyShowTargetRate\": false,\n  \"showAllDayLocksForInterpolatedRates\": false,\n  \"rates\": [],\n  \"rateRange\": {\n    \"@class\": \"com.cre8techlabs.entity.range.DoubleRangeLeGt\",\n    \"null\": true\n  },\n  \"maxListingPerRate\": 15,\n  \"showPayeeDetail\": false,\n  \"allDayLocks\": false,\n  \"dayLocksCriteria\": [],\n  \"encounteredUserGroups\": {},\n  \"useApplicationDateAsPricingDate\": false,\n  \"listAllRateProducts\": false,\n  \"fields\": [],\n  \"externalCompensation\": {\n    \"compPlanDollarRange\": {\n      \"id\": \"665a0bceac546f0001777709\",\n      \"from\": null,\n      \"to\": null\n    },\n    \"overrideComplan\": 0,\n    \"overrideComplanFlatFee\": 0\n  },\n  \"useExternalCompensation\": false,\n  \"byPassCap\": false,\n  \"fhaloanTypeCriteria\": [\n    \"STANDARD\"\n  ],\n  \"isMulti\": false,\n  \"companyId\": \"63c9b5fa24aa9a0001f0625b\",\n  \"name\": \"BEE_FFZSWS\",\n  \"rate\": null,\n  \"_tmp\": null\n}","dynamicTestDataDetails":[]} });
  });
});
